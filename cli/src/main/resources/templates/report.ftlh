<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>${title}</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            margin: 24px;
        }

        h1, h2 {
            margin-bottom: 8px;
        }

        .meta {
            color: #666;
            margin-bottom: 16px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 16px 0;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }

        th {
            background: #f4f4f4;
            text-align: left;
        }

        .pos {
            color: #1b5e20;
            font-weight: 600;
        }

        .neg {
            color: #b00020;
            font-weight: 600;
        }

        .chart {
            text-align: center;
            margin: 16px 0;
        }

        .foot {
            color: #777;
            font-size: 12px;
            margin-top: 24px;
        }

        code {
            background: #f6f8fa;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
<h1>${title}</h1>
<div class="meta">
    Period: <strong>${month}</strong>
    <#if generatedAt??> â€¢ Generated: ${generatedAt}</#if>
</div>


<h2>Overview</h2>
<table>
    <tr>
        <th>Total Income</th>
        <td>${overview.totalIncome?string["#,##0.00"]}</td>
    </tr>
    <tr>
        <th>Total Expense</th>
        <td>${overview.totalExpense?string["#,##0.00"]}</td>
    </tr>
    <tr>
        <th>Net Savings</th>
        <td>
            <#assign net = overview.totalIncome - overview.totalExpense>
            <span class="${(net >= 0)?then('pos','neg')}">
          ${net?string["#,##0.00"]}
        </span>
        </td>
    </tr>
    <tr>
        <th>Transactions</th>
        <td>${overview.count}</td>
    </tr>
</table>

<h2>Spend vs Budget by Category</h2>
<div class="chart">
    <#if charts.spendVsBudget??>
        <img src="${charts.spendVsBudget}" alt="Spend vs Budget chart" width="640"/>
    <#else>
        <em>No chart available.</em>
    </#if>
</div>
<table>
    <thead>
    <tr>
        <th>Category</th>
        <th>Budget</th>
        <th>Spend</th>
        <th>Variance</th>
    </tr>
    </thead>
    <tbody>
    <#list reportRows as r>
        <#if r?? && r.category??>
            <tr>
                <td>${r.category}</td>
                <td>${r.budget?string["#,##0.00"]}</td>
                <td>${r.spend?string["#,##0.00"]}</td>
                <td>
        <span class="${(r.variance >= 0)?then('pos','neg')}">
          ${r.variance?string["#,##0.00"]}
        </span>
                </td>
            </tr>
        </#if>
    </#list>

    </tbody>
</table>

<h2>Top Categories</h2>
<div class="chart">
    <#if charts.topCategories??>
        <img src="${charts.topCategories}" alt="Top Categories chart" width="640"/>
    <#else>
        <em>No chart available.</em>
    </#if>
</div>

<div class="foot">
    Generated by PFM CLI. Export with <code>pfm report-export --month YYYY-MM --out report.html</code>.
</div>
</body>
</html>
